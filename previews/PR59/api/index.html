<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · AdmissionSuite.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://timholy.github.io/AdmissionSuite.jl/api/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AdmissionSuite.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../web/">Web application</a></li><li><span class="tocitem">How AdmissionSuite works</span><ul><li><a class="tocitem" href="../simulation/">Offers</a></li><li><a class="tocitem" href="../targets/">Targets</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#API-reference:-Admit"><span>API reference: Admit</span></a></li><li><a class="tocitem" href="#API-reference:-AdmitConfiguration"><span>API reference: AdmitConfiguration</span></a></li><li><a class="tocitem" href="#API-reference:-AdmissionTargets"><span>API reference: AdmissionTargets</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/timholy/AdmissionSuite.jl/blob/master/docs/src/api.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="API-reference:-Admit"><a class="docs-heading-anchor" href="#API-reference:-Admit">API reference: Admit</a><a id="API-reference:-Admit-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference:-Admit" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Admit.NormalizedApplicant" href="#Admit.NormalizedApplicant"><code>Admit.NormalizedApplicant</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>NormalizedApplicant</code> holds normalized data about an applicant who received, or may receive, an offer of admission.</p><ul><li><p><code>applicantdata::PersonalData</code></p><p>Individual data about the applicant, see <a href="#Admit.PersonalData"><code>PersonalData</code></a>.</p></li></ul><ul><li><p><code>program::String</code></p><p>The abbreviation of the program the applicant was admitted to. <code>Admit.program_lookups</code> contains the list of valid choices, together with their full names.</p></li></ul><ul><li><p><code>season::Int16</code></p><p>The year in which the applicant&#39;s decision was due. E.g., if the decision deadline was April 15th, 2021, this would be 2021.</p></li></ul><ul><li><p><code>normrank::Union{Missing, Float32}</code></p><p>Normalized rank of the applicant: the top applicant has a rank near 0 (e.g., 1/302), and the bottom applicant has rank 1. The rank is computed among all applicants, not just those who received an offer of admission.</p></li></ul><ul><li><p><code>normofferdate::Union{Missing, Float32}</code></p><p>Normalized date at which the applicant received the offer of admission. 0 = date of first offer of season, 1 = decision date (typically April 15th). Candidates who were admitted in the first round would have a value of 0 (or near it), whereas candidates who were on the wait list and eventually received offers would have a larger value for this parameter.</p></li></ul><ul><li><p><code>normdecidedate::Union{Missing, Float32}</code></p><p>Normalized date at which the applicant replied with a decision. This uses the same scale as <code>normofferdate</code>. Consequently, an applicant who decided almost immediately would have a <code>normdecidedate</code> shortly after the <code>normofferdate</code>, whereas a candidate who decided on the final day will have a value of 1.0.</p><p>Use <code>missing</code> if the applicant has not yet decided.</p></li></ul><ul><li><p><code>accept::Union{Missing, Bool}</code></p><p><code>true</code> if the applicant accepted our offer, <code>false</code> if not. Use <code>missing</code> if the applicant has not yet decided.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/types.jl#L127-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.NormalizedApplicant-Tuple{}" href="#Admit.NormalizedApplicant-Tuple{}"><code>Admit.NormalizedApplicant</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">normapp = NormalizedApplicant(; program, urmdd=missing, foreign=missing, rank=missing, offerdate, decidedate=missing, accept=missing, program_history)</code></pre><p>Create an applicant from &quot;natural&quot; units, where rank is an integer and dates are expressed in <code>Date</code> format. Some are required (those without a default value), others are optional:</p><ul><li><code>program</code>: a string encoding the program</li><li><code>urmdd</code>: <code>true</code> if applicant is a URM, disadvantaged, or disabled</li><li><code>foreign</code>: <code>true</code> if applicant is not a citizen or permanent resident</li><li><code>rank::Int</code>: the rank of the applicant compared to other applicants to the same program in the same season.  Use 1 for the top candidate; the bottom candidate should have rank equal to the number of applications received.</li><li><code>offerdate</code>: the date on which an offer was (or might be) extended. E.g., <code>Date(&quot;2021-01-13&quot;)</code>.</li><li><code>decidedate</code>: the date on which the candidate replied with a verdict, or <code>missing</code></li><li><code>accept</code>: <code>true</code> if the candidate accepted our offer, <code>false</code> if it was turned down, <code>missing</code> if it is unknown.</li></ul><p><code>program_history</code> should be a dictionary mapping <a href="#Admit.ProgramKey"><code>ProgramKey</code></a>s to <a href="#Admit.ProgramData"><code>ProgramData</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/types.jl#L177-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.Outcome" href="#Admit.Outcome"><code>Admit.Outcome</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Outcome(ndeclines, naccepts)</code></pre><p>Tally of the number of declines and accepts for offers of admission.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/types.jl#L277-L281">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.PersonalData" href="#Admit.PersonalData"><code>Admit.PersonalData</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>PersonalData</code> holds relevant data about an individual applicant.</p><ul><li><p><code>name::String</code></p><p>Name of the applicant</p></li></ul><ul><li><p><code>urmdd::Union{Missing, Bool}</code></p><p><code>true</code> if an applicant is an underrepresented minority, disadvantaged, or disabled.</p></li></ul><ul><li><p><code>foreign::Union{Missing, Bool}</code></p><p><code>true</code> if an applicant is not a US citizen or permanent resident.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/types.jl#L88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.ProgramData" href="#Admit.ProgramData"><code>Admit.ProgramData</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>ProgramData</code> stores summary data for a particular program and admissions season.</p><ul><li><p><code>target_raw::Int64</code></p><p>The target number of matriculants, based on applicant pool and training capacity.</p></li></ul><ul><li><p><code>target_corrected::Int64</code></p><p>The actual target, correcting for over- or under-recruitment in previous years.</p></li></ul><ul><li><p><code>nmatriculants::Union{Missing, Int64}</code></p><p>The number of matriculated students, or <code>missing</code>.</p></li></ul><ul><li><p><code>napplicants::Int64</code></p><p>The number of applicants received.</p></li></ul><ul><li><p><code>firstofferdate::Dates.Date</code></p><p>The date on which the first offer was made, essentially the beginning of the decision period for the applicants.</p></li></ul><ul><li><p><code>lastdecisiondate::Dates.Date</code></p><p>The date on which all applicants must have rendered a decision, or the offer expires.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/types.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.ProgramKey" href="#Admit.ProgramKey"><code>Admit.ProgramKey</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>ProgramKey</code> stores the program name and admissions season.</p><ul><li><p><code>program::String</code></p><p>The program abbreviation. <code>Admit.program_lookups</code> contains the list of valid choices, together will full names.</p></li></ul><ul><li><p><code>season::Int16</code></p><p>The enrollment year. This is the year in which the applicant&#39;s decision was due. E.g., if the last date was April 15th, 2021, this would be 2021.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/types.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.ProgramYieldPrediction" href="#Admit.ProgramYieldPrediction"><code>Admit.ProgramYieldPrediction</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>ProgramYieldPrediction</code> records mid-season predictions and data for a particular program.</p><ul><li><p><code>nmatriculants::Measurements.Measurement{Float32}</code></p><p>The predicted number of matriculants.</p></li></ul><ul><li><p><code>priority::Float32</code></p><p>The program&#39;s priority for receiving wait list offers. The program with the highest priority should get the next offer. Priority is computed as <code>deficit/stddev</code>, where <code>deficit</code> is the predicted undershoot (which might be negative if the program is predicted to overshoot) and <code>stddev</code> is the square root of the target (Poisson noise). Thus, programs are prioritized by the significance of the deficit.</p></li></ul><ul><li><p><code>poutcome::Union{Missing, Float32}</code></p><p>The two-tailed p-value of the actual outcome (if supplied). This includes the effects of any future wait-list offers.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/types.jl#L301-L305">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.add_offers!" href="#Admit.add_offers!"><code>Admit.add_offers!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nmatric, pq0=&gt;pq = add_offers!(fmatch, program_offers::Dict, program_candidates::Dict, past_applicants, tnow::Date=today(), σthresh=2; program_history)</code></pre><p>Transfer applicants from <code>program_candidates</code> to <code>program_offers</code> depending on whether projections in <code>nmatric</code> are below DBBS-wide target by at least <code>σthresh</code> standard deviations.  <code>nmatric0</code> is computed upon entrance, while <code>nmatric</code> reflects updated projections after adding offers. Likewise <code>pq0</code> is the program-priority initially, and <code>pq</code> after adding offers.</p><p><code>tnow</code> should be the date for which the computation should be performed, and is used to determine whether candidates have already informed us of their decision.</p><p>Programs are prioritized for offers by the deficit divided by the expected noise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/predict.jl#L122-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.aggregate-Tuple{Union{AbstractDict{ProgramKey, ProgramData}, AbstractVector{Pair{ProgramKey, ProgramData}}}, Any}" href="#Admit.aggregate-Tuple{Union{AbstractDict{ProgramKey, ProgramData}, AbstractVector{Pair{ProgramKey, ProgramData}}}, Any}"><code>Admit.aggregate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">proghist = aggregate(program_history::ListPairs{ProgramKey, ProgramData}, mergepairs)</code></pre><p>Aggregate program history, merging program <code>from =&gt; to</code> pairs from <code>mergepairs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/utils.jl#L65-L69">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.cached_similarity-Tuple{Any, Any}" href="#Admit.cached_similarity-Tuple{Any, Any}"><code>Admit.cached_similarity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fsim = cached_similarity(σsel, σyield; offerdata, yielddata)</code></pre><p>Cache the result of <a href="#Admit.program_similarity-Tuple{AbstractString, AbstractString}"><code>program_similarity</code></a>, creating a function <code>fsim(program1::AbstractString, program2::AbstractString)</code> to compute the similarity between <code>program1</code> and <code>program2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/similarity.jl#L127-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.extract_program_history" href="#Admit.extract_program_history"><code>Admit.extract_program_history</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">program_history = extract_program_history(applicants)
program_history = extract_program_history(applicants, program_metadata)</code></pre><p>Assemble the necessary <code>program_history</code> from <code>applicants</code> and external <code>program_metadata</code>. <code>applicants</code> is parsed to identify the date of the first offer for each <code>ProgramKey(program, season)</code> combination. The remaining data come from <code>program_metadata</code>, which can be obtained from <a href="#Admit.parse_programs-Tuple{DataFrames.DataFrame}"><code>parse_programs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/sql.jl#L134-L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.generate_fake_candidates" href="#Admit.generate_fake_candidates"><code>Admit.generate_fake_candidates</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">program_candidates = generate_fake_candidates(program_history, season::Integer, program_offer_dates=nothing)</code></pre><p>Generate fake candidates for each program, each ranked starting from 1. <code>season</code> is the year for which the offers should be generated. Optionally provide <code>program_offer_dates</code>, a <code>program_name=&gt;list_of_offer_dates</code> dictionary which will be used to generate offer dates (by default set to the <code>firstofferdate</code> in <code>program_history</code>). Unless <code>σt</code> is quite small in the matching function, adding additional offer dates (e.g., for multiple interview dates) may not change the outcome substantially.</p><p>On output, <code>program_candidates</code> is a <code>Dict(program1=&gt;[applicant1a, applicant1b, ...], ...)</code> storing the fake applicants per program in rank order. See <a href="#Admit.initial_offers!-Tuple{Function, Dict, Vararg{Any, N} where N}"><code>initial_offers!</code></a>.</p><p><strong>Example</strong></p><p>This calculates the number of initial offers per program:</p><pre><code class="nohighlight hljs">julia&gt; program_candidates = Admit.generate_fake_candidates(program_history, 2021);

julia&gt; program_offers = initial_offers!(fmatch, program_candidates, past_applicants, Date(&quot;2021-01-01&quot;); program_history);

julia&gt; noffers = sort([prog =&gt; length(list) for (prog, list) in program_offers]; by=first)
13-element Vector{Pair{String, Int64}}:
  &quot;BBSB&quot; =&gt; 16
  &quot;BIDS&quot; =&gt; 9
    &quot;CB&quot; =&gt; 13
   &quot;CSB&quot; =&gt; 14
 &quot;DRSCB&quot; =&gt; 14
  &quot;EEPB&quot; =&gt; 12
   &quot;HSG&quot; =&gt; 9
   &quot;IMM&quot; =&gt; 16
   &quot;MCB&quot; =&gt; 16
   &quot;MGG&quot; =&gt; 18
  &quot;MMMP&quot; =&gt; 18
    &quot;NS&quot; =&gt; 31
   &quot;PMB&quot; =&gt; 14</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/utils.jl#L111-L148">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.initial_offers!-Tuple{Function, Dict, Vararg{Any, N} where N}" href="#Admit.initial_offers!-Tuple{Function, Dict, Vararg{Any, N} where N}"><code>Admit.initial_offers!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">program_offers, nmatric = initial_offers!(fmatch, program_candidates::Dict, past_applicants, tnow::Date=today(), σthresh=2; program_history)</code></pre><p>Allocate initial offers of admission at the beginning of the season.  See <a href="#Admit.add_offers!"><code>add_offers!</code></a> for more information. See also <a href="#Admit.generate_fake_candidates"><code>generate_fake_candidates</code></a> to plan offers in cases where some programs want to make their initial offers before other programs have finished interviewing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/predict.jl#L198-L204">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.keep_final_records-Tuple{Any}" href="#Admit.keep_final_records-Tuple{Any}"><code>Admit.keep_final_records</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">keep_final_records(apps)</code></pre><p>De-duplicate applicant entries retrieved from the database. For each (<code>season</code>, <code>name</code>) combination, this keeps only the most recently updated entry.</p><p>This requires that you define a <code>when_updated(row)</code> function for your database format, see <a href="#AdmitConfiguration.set_local_functions-Tuple{AbstractString}"><code>AdmitConfiguration.set_local_functions</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/sql.jl#L40-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.manage_offers" href="#Admit.manage_offers"><code>Admit.manage_offers</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">app = manage_offers(fetch_past_applicants::Function, fetch_applicants::Function, fetch_program_data::Function, tnow::Union{Date,Function}=today;
                    σthresh::Real=2,
                    σsel=0.2f0, σyield=1.0f0, σr=0.5f0, σt=Inf32)</code></pre><p>Create a report about the current state of admissions. The report has 3 tabs:</p><ul><li>&quot;Summary&quot; gives an overview across all programs, along with a list of candidates deemed ready to receive an offer given the target in the entry box at the top right.</li><li>&quot;Program&quot; provides a detailed view of a single program selected in the dropdown at the top right, showing candidates who have accepted or rejected the offer of admission, along with a predicted matriculation probability for each undecided applicant.</li><li>&quot;Internals&quot; provides information about the model details, currently just the &quot;Program similarity&quot; score which expresses the use of cross-program data in predicting matriculation probability.</li></ul><p>The &quot;Refresh applicants&quot; button fetches fresh data about the current applicants, and should be used to update projections as decisions get made.</p><p>The input arguments are:</p><ul><li><code>fetch_past_applicants()</code> should return a list of <code>NormalizedApplicant</code>s from previous admissions years. These will be used to make predictions about the decisions of current applicants.</li><li><code>fetch_applicants()</code> should return a list of <code>NormalizedApplicant</code>s from the current season. This gets called every time you click &quot;Refresh applicants&quot;.</li><li><code>fetch_program_data()</code> should return a <code>Dict{ProgramKey,ProgramData}</code> containing overall statistics about the program over the time covered by the combination of <code>fetch_past_applicants</code> and <code>fetch_applicants</code>.</li><li><code>tnow</code> can either be a <code>Date</code> or a function returning a <code>Date</code>. The default, the function <code>Dates.today</code>, will update the date every time the page renders. Pass a static date only if you don&#39;t want the date updating.</li><li><code>σthresh</code> determines how conservative the system will be in extending wait-list offers. On the &quot;Summary&quot; tab, the &quot;Total estimate&quot; will be expressed as <code>mean ± stddev</code>, and <code>mean + σthresh * stddev</code> will be held approximately at the total target. Larger values of <code>σthresh</code> make it less likely that you&#39;ll overshoot, and more likely that you&#39;ll undershoot. Values in the range of 0-3 seem like plausible choices (default: 2).</li><li><code>σsel</code> and <code>σyield</code> determine the cross-program similarity (see <a href="#Admit.program_similarity-Tuple{AbstractString, AbstractString}"><code>program_similarity</code></a>)</li><li><code>σr</code> and <code>σt</code> determine how much the prediction uses applicant rank and offer date, respectively (see <a href="#Admit.match_function-Tuple{}"><code>match_function</code></a>).</li></ul><p>To render the report in a browser, use</p><pre><code class="nohighlight hljs">Admit.run_server(app, &quot;0.0.0.0&quot;, debug=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/web.jl#L37-L73">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.match_correlation-Tuple{Function, Vararg{AbstractVector{T} where T, N} where N}" href="#Admit.match_correlation-Tuple{Function, Vararg{AbstractVector{T} where T, N} where N}"><code>Admit.match_correlation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">match_correlation(matchcreator::Function, σlists::AbstractVector...;
                  applicants, program_history, kwargs...)</code></pre><p>Compute the prediction accuracy using historical data. For each year in <code>program_history</code> other than the earliest, use prior data to predict the probability of matriculation for each applicant.</p><p>The <code>σ</code> lists contain the values that will be used to compute accuracy; the return value is an n-dimensional array evaluating the correlation between estimated matriculation probability and acceptance for all possible combinations of these parameters. <code>matchcreator(σ1, σ2...; offerdata, yielddata)</code> should return a similarity-computing function <code>fmatch(template, applicant, tnow)</code> using the specific <code>σ</code>s provided.</p><p>Tuning essentially corresponds to picking the index of the entry of the return value and then setting each parameter accordingly:</p><pre><code class="language-julia hljs">corarray = match_correlation(Admit.fmatch_prog_rank_date, σsels, σyields, σrs, σts; applicants, program_history)
idx = argmax(corarray)
σsel, σyield, σr, σt = σsels[idx[1]], σyields[idx[2]], σrs[idx[3]], σts[idx[4]]</code></pre><p><code>fmatch_prog_rank_date</code> is a default and can be omitted if you want to use this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/predict.jl#L261-L282">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.match_correlation-Tuple{Function}" href="#Admit.match_correlation-Tuple{Function}"><code>Admit.match_correlation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">match_correlation(fmatch; applicants, past_applicants, ptail=0.0f0, minfrac=0.01)</code></pre><p>Compute the correlation between estimated matriculation probability and decline/accept for a list of <code>applicants</code>&#39; matriculation decisions. This function is used to evaluate the accuracy of predictions made by specific model parameters.</p><p><code>fmatch(reference, applicant, tnow)</code> is the similarity-computation function. <code>ptail</code> is used to clamp the estimated matriculation probability between bounds, <code>clamp(pmatric, ptail, 1-ptail)</code>. <code>minfrac</code> expresses the minimum fraction of <code>past_applicants</code> allowed to be matched; any <code>test_applicant</code> matching fewer than these (in the sense of the sum of likelihoods computed by <a href="#Admit.match_likelihood-Tuple{Any, AbstractVector{NormalizedApplicant}, NormalizedApplicant, Dates.Date}"><code>match_likelihood</code></a>) leads to a return value of <code>NaN</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/predict.jl#L238-L250">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.match_function-Tuple{}" href="#Admit.match_function-Tuple{}"><code>Admit.match_function</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fmatch = match_function(; σr=Inf32, σt=Inf32, progsim=default_similarity)</code></pre><p>Generate a matching function comparing two applicants.</p><pre><code class="nohighlight hljs">fmatch(template::NormalizedApplicant, applicant::NormalizedApplicant, tnow::Union{Real,Missing})</code></pre><p>will return a number between 0 and 1, with 1 indicating a perfect match. <code>template</code> is the applicant you wish to find a match for, and <code>applicant</code> is a candidate match. <code>tnow</code> is used to exclude <code>applicant</code>s who had already decided by <code>tnow</code>.</p><p>The parameters of <code>fmatch</code> are determined by <code>criteria</code>:</p><ul><li><code>σr</code>: the standard deviation of <code>normrank</code> (use <code>Inf</code> or <code>missing</code> if you don&#39;t want to consider rank in matches)</li><li><code>σt</code>: the standard deviation of <code>normofferdate</code> (use <code>Inf</code> or <code>missing</code> if you don&#39;t want to consider offer date in matches)</li><li><code>progsim</code>: a function <code>progsim(program1, program2)</code> computing the &quot;similarity&quot; between programs. See <a href="#Admit.cached_similarity-Tuple{Any, Any}"><code>cached_similarity</code></a>. The default returns <code>true</code> if <code>program1 == program2</code> and <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/similarity.jl#L186-L203">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.match_likelihood-Tuple{Any, AbstractVector{NormalizedApplicant}, NormalizedApplicant, Dates.Date}" href="#Admit.match_likelihood-Tuple{Any, AbstractVector{NormalizedApplicant}, NormalizedApplicant, Dates.Date}"><code>Admit.match_likelihood</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">likelihood = match_likelihood(fmatch, past_applicants, applicant, tnow::Date; program_history)</code></pre><p>Use this format if supplying <code>tnow</code> in <code>Date</code> format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/similarity.jl#L172-L176">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.match_likelihood-Union{Tuple{F}, Tuple{F, AbstractVector{NormalizedApplicant}, NormalizedApplicant, Float32}} where F" href="#Admit.match_likelihood-Union{Tuple{F}, Tuple{F, AbstractVector{NormalizedApplicant}, NormalizedApplicant, Float32}} where F"><code>Admit.match_likelihood</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">likelihood = match_likelihood(fmatch::Function,
                              past_applicants::AbstractVector{NormalizedApplicant},
                              applicant::NormalizedApplicant,
                              tnow::Real)</code></pre><p>Compute the likelihood among <code>past_applicants</code> for matching <code>applicant</code>. <code>tnow</code> is the current date in normalized form (see <a href="#Admit.normdate-Tuple{Dates.Date, ProgramData}"><code>normdate</code></a>), and is used to exclude previous applicants who had already made a decision by <code>tnow</code>.</p><p>See also: <a href="#Admit.match_function-Tuple{}"><code>match_function</code></a>, <a href="#Admit.select_applicant-Tuple{Any, Any}"><code>select_applicant</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/similarity.jl#L151-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.matriculation_probability-Tuple{Any, Any}" href="#Admit.matriculation_probability-Tuple{Any, Any}"><code>Admit.matriculation_probability</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">p = matriculation_probability(likelihood, past_applicants)</code></pre><p>Compute the probability that applicants weighted by <code>likelihood</code> would matriculate into the program, based on the choices made by <code>past_applicants</code>.</p><p><code>likelihood</code> can be computed by <a href="#Admit.match_likelihood-Tuple{Any, AbstractVector{NormalizedApplicant}, NormalizedApplicant, Dates.Date}"><code>match_likelihood</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/predict.jl#L4-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.normdate-Tuple{Dates.Date, ProgramData}" href="#Admit.normdate-Tuple{Dates.Date, ProgramData}"><code>Admit.normdate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">normdate(t::Date, pdata::ProgramData)</code></pre><p>Express <code>t</code> as a fraction of the gap between the first offer date and last decision date as stored in <code>pdata</code> (see <a href="#Admit.ProgramData"><code>ProgramData</code></a>).</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Dates

julia&gt; pd = ProgramData(firstofferdate=Date(&quot;2021-02-11&quot;), lastdecisiondate=Date(&quot;2021-04-15&quot;))
ProgramData(0, 0, missing, -1, Date(&quot;2021-02-11&quot;), Date(&quot;2021-04-15&quot;))

julia&gt; normdate(Date(&quot;2021-02-11&quot;), pd)
0.0f0

julia&gt; normdate(Date(&quot;2021-04-15&quot;), pd)
1.0f0

julia&gt; normdate(Date(&quot;2021-03-15&quot;), pd)
0.50793654f0

julia&gt; normdate(Date(&quot;2021-01-01&quot;), pd)    # dates prior to the first offer date are negatve
-0.6507937f0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/utils.jl#L9-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.offerdata-Tuple{Any, Any}" href="#Admit.offerdata-Tuple{Any, Any}"><code>Admit.offerdata</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">offerdata(applicants, program_history)</code></pre><p>Summarize application and offer data for each program. The output is a dictionary mapping <code>programname =&gt; (noffers, napplicants)</code>. The program selectivity is the ratio <code>noffers/napplicants</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/similarity.jl#L23-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.parse_database-Tuple{Any}" href="#Admit.parse_database-Tuple{Any}"><code>Admit.parse_database</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">applicants, program_history = parse_database(conn)</code></pre><p>Extract the <code>applicants</code> and <code>program_history</code> from the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/sql.jl#L199-L203">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.parse_programs-Tuple{DataFrames.DataFrame}" href="#Admit.parse_programs-Tuple{DataFrames.DataFrame}"><code>Admit.parse_programs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">program_metadata = parse_programs(programs::DataFrame)</code></pre><p>Extract program metadata:</p><ul><li>target number of matriculants, aka &quot;slots&quot;</li><li>total number of applicants</li><li>total number of matriculants (i.e., number who accepted the offer of admission)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/sql.jl#L116-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.program_similarity-Tuple{AbstractString, AbstractString}" href="#Admit.program_similarity-Tuple{AbstractString, AbstractString}"><code>Admit.program_similarity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">program_similarity(program1::AbstractString, program2::AbstractString;
                   σsel=Inf32, σyield=Inf32, offerdata, yielddata)</code></pre><p>Compute the similarity between <code>program1</code> and <code>program2</code>, based on selectivity (fraction of applicants who are admitted) and yield (fraction of offers that get accepted). The similarity ranges between 0 and 1, with 1 corresponding to identical programs.</p><p>The keyword arguments are the parameters controlling the similarity computation. <code>offerdata</code> and <code>yielddata</code> are the outputs of two functions of the same name (<a href="#Admit.offerdata-Tuple{Any, Any}"><code>offerdata</code></a> and <a href="#Admit.yielddata-Union{Tuple{Y}, Tuple{Type{Y}, Any}} where Y&lt;:Union{Outcome, Tuple{Outcome, Vararg{Outcome, N} where N}}"><code>yielddata</code></a>). <code>σsel</code> and <code>σyield</code> are the standard deviations of selectivity and yield. The similarity is computed as</p><p class="math-container">\[\exp\left(-\frac{(s₁ - s₂)²}{2σ_\text{sel}²} - \frac{(y₁ - y₂)²}{2σ_\text{yield}²}\right).\]</p><p>The output of this function can be cached with <a href="#Admit.cached_similarity-Tuple{Any, Any}"><code>cached_similarity</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/similarity.jl#L84-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.query_applicants-Tuple{Any}" href="#Admit.query_applicants-Tuple{Any}"><code>Admit.query_applicants</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">apps = query_applicants(conn; deduplicate=false)</code></pre><p>Fetch all applicants (past and present) from the database using connection <code>conn</code>. <code>apps</code> is a DataFrame. Configure the SELECT statement using <a href="#AdmitConfiguration.set_sql_queries-Tuple{}"><code>set_sql_queries</code></a>.</p><p>If your database contains multiple entries for each applicant, set <code>deduplicate=true</code> and see the configuration needed for <a href="#Admit.keep_final_records-Tuple{Any}"><code>keep_final_records</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/sql.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.query_programs-Tuple{Any}" href="#Admit.query_programs-Tuple{Any}"><code>Admit.query_programs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">progdata = query_programs(conn)</code></pre><p>Fetch program targets and other information from the database using connection <code>conn</code>. <code>progdata</code> is a DataFrame. Configure the SELECT statement using <a href="#AdmitConfiguration.set_sql_queries-Tuple{}"><code>set_sql_queries</code></a>.</p><p>If your database contains multiple entries for each applicant, set <code>deduplicate=true</code> and see the configuration needed for <a href="#Admit.keep_final_records-Tuple{Any}"><code>keep_final_records</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/sql.jl#L18-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.read_applicant_data-Tuple{AbstractString}" href="#Admit.read_applicant_data-Tuple{AbstractString}"><code>Admit.read_applicant_data</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">past_applicants = read_applicant_data(filename; program_history)</code></pre><p>Read past applicant data from a file. See &quot;/home/runner/work/AdmissionSuite.jl/AdmissionSuite.jl/Admit/src/test/data/applicantdata.csv&quot; for an example of the format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/io.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.read_program_history-Tuple{AbstractString}" href="#Admit.read_program_history-Tuple{AbstractString}"><code>Admit.read_program_history</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">program_history = read_program_history(filename)</code></pre><p>Read program history from a file. See &quot;/home/runner/work/AdmissionSuite.jl/AdmissionSuite.jl/Admit/src/test/data/programdata.csv&quot; for an example of the format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/io.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.run_simulation" href="#Admit.run_simulation"><code>Admit.run_simulation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nmatriculants = run_simulation(pmatrics::AbstractVector, nsim::Int=100)</code></pre><p>Given a list of candidates each with probability of matriculation <code>pmatrics[i]</code>, perform <code>nsim</code> simulations of their admission decisions and compute the total number of matriculants in each simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/predict.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.select_applicant-Tuple{Any, Any}" href="#Admit.select_applicant-Tuple{Any, Any}"><code>Admit.select_applicant</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">past_applicant = select_applicant(clikelihood, past_applicants)</code></pre><p>Select a previous applicant from among <code>past_applicants</code>, using the cumulative likelihood <code>clikelihood</code>. This can be computed as <code>cumsum(likelihood)</code>, where <code>likelihood</code> is computed by <a href="#Admit.match_likelihood-Tuple{Any, AbstractVector{NormalizedApplicant}, NormalizedApplicant, Dates.Date}"><code>match_likelihood</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/predict.jl#L28-L33">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.wait_list_analysis-Union{Tuple{F}, Tuple{F, AbstractVector{NormalizedApplicant}, AbstractVector{NormalizedApplicant}, Union{Dates.Date, Real}}} where F" href="#Admit.wait_list_analysis-Union{Tuple{F}, Tuple{F, AbstractVector{NormalizedApplicant}, AbstractVector{NormalizedApplicant}, Union{Dates.Date, Real}}} where F"><code>Admit.wait_list_analysis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nmatric, progstatus = wait_list_analysis(fmatch::Function,
                                         past_applicants::AbstractVector{NormalizedApplicant},
                                         applicants::AbstractVector{NormalizedApplicant},
                                         tnow::Date;
                                         program_history,
                                         actual_yield=nothing)</code></pre><p>Compute the estimated number <code>nmatric</code> of matriculants and the program-specific yield prediction and wait-list priority, <code>progstatus</code>. <code>progstatus</code> is a mapping <code>progname =&gt; progyp::ProgramYieldPrediction</code> (see <a href="#Admit.ProgramYieldPrediction"><code>ProgramYieldPrediction</code></a>). <code>nmatric</code> assumes all <code>applicants</code> get offers.</p><p>The arguments are similarly to <a href="#Admit.match_likelihood-Tuple{Any, AbstractVector{NormalizedApplicant}, NormalizedApplicant, Dates.Date}"><code>match_likelihood</code></a>. If you&#39;re doing a post-hoc analysis, <code>actual_yield</code> can be a <code>Dict(progname =&gt; nmatric)</code>, in which case the p-value for the observed outcome will also be stored in <code>progstatus</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/predict.jl#L60-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.yield_errors-Tuple{Any, Any}" href="#Admit.yield_errors-Tuple{Any, Any}"><code>Admit.yield_errors</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">yerrs = yield_errors(σsels, σyields; applicants, program_history)</code></pre><p>Given lists of possible <code>σsel</code> and <code>σyield</code> values, compute the cross-program error in predicted yield. On output, <code>yerrs[i,j]</code> is the yield error when using <code>σsels[i]</code> and <code>σyields[j]</code>.</p><p>The yield error is based on predicting each years&#39; yield from prior data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/similarity.jl#L286-L293">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Admit.yielddata-Union{Tuple{Y}, Tuple{Type{Y}, Any}} where Y&lt;:Union{Outcome, Tuple{Outcome, Vararg{Outcome, N} where N}}" href="#Admit.yielddata-Union{Tuple{Y}, Tuple{Type{Y}, Any}} where Y&lt;:Union{Outcome, Tuple{Outcome, Vararg{Outcome, N} where N}}"><code>Admit.yielddata</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">yielddata(Outcome, applicants)
yielddata(Tuple{Outcome,Outcome,Outcome}, applicants)</code></pre><p>Compute the outcome of offers of admission for each program. <code>applicants</code> should be a list of <a href="#Admit.NormalizedApplicant"><code>NormalizedApplicant</code></a>. The first form computes the <a href="#Admit.Outcome"><code>Outcome</code></a> for the entire season, and the second breaks the season up into epochs of equal duration and computes the outcome for each epoch separately. If provided, <a href="#Admit.program_similarity-Tuple{AbstractString, AbstractString}"><code>program_similarity</code></a> will make use of the time-dependence of the yield.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/Admit/src/similarity.jl#L65-L73">source</a></section></article><h2 id="API-reference:-AdmitConfiguration"><a class="docs-heading-anchor" href="#API-reference:-AdmitConfiguration">API reference: AdmitConfiguration</a><a id="API-reference:-AdmitConfiguration-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference:-AdmitConfiguration" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.addprogram-Tuple{AbstractString}" href="#AdmitConfiguration.addprogram-Tuple{AbstractString}"><code>AdmitConfiguration.addprogram</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">addprogram(abbrv::AbstractString)</code></pre><p>Dynamically add a new program with abbreviation <code>abbrv</code>.</p><p>This is primarily used for writing tests; most users should use <a href="#AdmitConfiguration.set_programs"><code>set_programs</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/utils.jl#L3-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.connectdsn" href="#AdmitConfiguration.connectdsn"><code>AdmitConfiguration.connectdsn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">conn = connectdsn()
conn = connectdsn(dsnname; usepasswd::Bool=false)</code></pre><p>Connect to a SQL database specified by a Data Source Name (DSN) <code>dsnname</code>, which by default is the one set by <a href="#AdmitConfiguration.set_dsn-Tuple{AbstractString}"><code>set_dsn</code></a>.</p><p>Set <code>usepasswd=true</code> if you need to authenticate with username/password.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/sql.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.delprogram-Tuple{AbstractString}" href="#AdmitConfiguration.delprogram-Tuple{AbstractString}"><code>AdmitConfiguration.delprogram</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">delprogram(abbrv::AbstractString)</code></pre><p>Dynamically delete the program with abbreviation <code>abbrv</code>.</p><p>This is primarily used for writing tests; most users should use <a href="#AdmitConfiguration.set_programs"><code>set_programs</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/utils.jl#L16-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.getaccept" href="#AdmitConfiguration.getaccept"><code>AdmitConfiguration.getaccept</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getaccept(row)</code></pre><p>Return <code>true</code> or <code>false</code> depending on whether the applicant in <code>row</code> (a row of the applicant table) accepted the offer of admission.</p><p><strong>Example</strong></p><p>Suppose your table has a column called &quot;Outcome&quot; which takes values &quot;Accept&quot;, &quot;Decline&quot;, &quot;Reject&quot;, or &quot;Withdrew&quot;. Then in simplest form you could implement this function as:</p><pre><code class="nohighlight hljs">getaccept(row) = row.&quot;Outcome&quot; == &quot;Accept&quot;</code></pre><p>More sophisticated implementations might check for unexpected values and throw an error if they are encountered.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/local_function_stubs.jl#L5-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.getdecidedate" href="#AdmitConfiguration.getdecidedate"><code>AdmitConfiguration.getdecidedate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getdecidedate(row)</code></pre><p>Return the date on which the applicant in <code>row</code>  (a row of the applicant table) informed admissions about their decision about whether to accept the offer of admission.</p><p><strong>Example</strong></p><p>Suppose your table has a column called &quot;Date of verdict&quot;, in which case implementing this would be as simple as</p><pre><code class="nohighlight hljs">getdecidedate(row) = row.&quot;Date of verdict&quot;</code></pre><p>In contrast, supposed you have multiple columns, &quot;Date of accept&quot;, &quot;Date of decline&quot;, &quot;Date of withdrawal&quot;, of which only one has an entry.  Then this might be implemented as</p><pre><code class="nohighlight hljs">function getdecidedate(row)
    if !ismissing(row.&quot;Date of accept&quot;)
        return row.&quot;Date of accept&quot;
    elseif !ismissing(row.&quot;Date of decline&quot;)
        return row.&quot;Date of decline&quot;
    elseif !ismissing(row.&quot;Date of withdrawal&quot;)
        return row.&quot;Date of withdrawal&quot;
    else
        error(&quot;expected one of the accept/decline/withdrawal dates to be specified&quot;)
    end
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/local_function_stubs.jl#L24-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.set_column_configuration-Tuple" href="#AdmitConfiguration.set_column_configuration-Tuple"><code>AdmitConfiguration.set_column_configuration</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_column_configuration(stdname1 =&gt; dbcolname1, ...)</code></pre><p>Configure the names of columns <code>dbcolname</code>s in your database so that standard properties can be extracted. The properties that must be configured are:</p><p>Applicant table columns:</p><ul><li>&quot;name&quot;: the name of the column that stores the applicant name</li><li>&quot;app program&quot;: the name of the column that stores the name of the program the applicant is being considered for admission in</li><li>&quot;offer date&quot;: the name of the column that stores the date at which an offer of admission was extended</li><li>&quot;app season&quot; (optional): the name of the column that can be used to extract the application season (e.g., 2022) if an offer date is not available for a candidate</li><li>&quot;rank&quot; (optional): the applicant rank assigned by the admissions committee/interviewers. From highest (top-rated) to lowest, they should be numbered 1, 2, 3, ... Each program should have separate ranking.</li><li>&quot;accept&quot; (optional): <code>true</code>/<code>false</code>/<code>missing</code> indicating whether the applicant accepted the offer of admission. The alternative to setting this column is <a href="#AdmitConfiguration.set_local_functions-Tuple{AbstractString}"><code>set_local_functions</code></a>.</li><li>&quot;decide date&quot; (optional): the date of the applicant&#39;s decision. The alternative to setting this column is <a href="#AdmitConfiguration.set_local_functions-Tuple{AbstractString}"><code>set_local_functions</code></a>.</li></ul><p>Program table columns:</p><ul><li>&quot;prog program&quot;: the name of the column that stores the program name</li><li>&quot;prog season&quot;: the name of the column that can be used to extract the application season (e.g., 2022)</li><li>&quot;slots&quot;: the name of the column that stores the matriculation target for a program</li><li>&quot;napplicants&quot; (optional): the name of the column that stores the number of applications received</li><li>&quot;nmatriculants&quot; (optional): the name of the column that stores the number of applicants who accepted the offer of admission</li></ul><p><strong>Example</strong></p><pre><code class="nohighlight hljs">set_column_configuration(&quot;name&quot; =&gt; &quot;Applicant Name&quot;, &quot;app program&quot; =&gt; &quot;Program&quot;, &quot;offer date&quot; =&gt; &quot;Acceptance Offered&quot;)</code></pre><p>sets up the names of three columns in your database tables.</p><p>See also: <a href="#AdmitConfiguration.set_local_functions-Tuple{AbstractString}"><code>set_local_functions</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/AdmitConfiguration.jl#L126-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.set_date_format-Tuple{AbstractString}" href="#AdmitConfiguration.set_date_format-Tuple{AbstractString}"><code>AdmitConfiguration.set_date_format</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_date_format(fmt::AbstractString)</code></pre><p>Specify how dates are represented. The default is <code>&quot;mm/dd/yyyy&quot;</code>.</p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; set_date_format(&quot;y-m-d H:M:S.s&quot;)</code></pre><p>to set a format that includes the time as well as date.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/AdmitConfiguration.jl#L182-L194">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.set_dsn-Tuple{AbstractString}" href="#AdmitConfiguration.set_dsn-Tuple{AbstractString}"><code>AdmitConfiguration.set_dsn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_dsn(name)</code></pre><p>Configure a Data Source <code>name</code> for a SQL database</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/AdmitConfiguration.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.set_local_functions-Tuple{AbstractString}" href="#AdmitConfiguration.set_local_functions-Tuple{AbstractString}"><code>AdmitConfiguration.set_local_functions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_local_functions(filename)</code></pre><p>Configure custom functions used in parsing applicant tables. The following functions must be implemented:</p><ul><li><a href="#AdmitConfiguration.getaccept"><code>getaccept</code></a></li><li><a href="#AdmitConfiguration.getdecidedate"><code>getdecidedate</code></a></li></ul><p>The following are optional and only required for certain functionality:</p><ul><li><a href="#AdmitConfiguration.when_updated"><code>when_updated</code></a></li></ul><p>Create these functions and save them to a file somewhere permanent on your system. Then pass the filename to <code>set_local_functions</code> to register this file with AdmissionSuite.</p><p>See also: <a href="#AdmitConfiguration.set_column_configuration-Tuple"><code>set_column_configuration</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/AdmitConfiguration.jl#L100-L116">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.set_programs" href="#AdmitConfiguration.set_programs"><code>AdmitConfiguration.set_programs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_programs(filename; force=false)</code></pre><p>Configure your local programs, given a CSV file <code>filename</code> of the format in <code>examples/WashU.csv</code>. (You can create such files with a spreadsheet program, exporting the table in &quot;Comma separated value&quot; format.) The minimum requirement is the <code>Abbreviation</code> column, which must contain the list of all programs in &quot;short-form&quot; name. Use <code>ProgramName</code> if you want a long-form name, especially if you use a SQL database which sometimes uses that name.</p><p><code>SeasonStart</code>, <code>SeasonEnd</code>, <code>MergeTo</code>, and <code>SplitFrom</code> can be used to track changes in your programs over time; this can be relevant because historical data is used to forecast matriculation probability (for <code>Admit.jl</code>) and faculty service (for <code>AdmissionTargets.jl</code>). &quot;Season&quot; refers to the year for final acceptance of an offer of admission, e.g., a deadline of April 15, 2013 would be season 2013. <code>SeasonStart</code> should contain the first season in which a program admitted applicants; <code>SeasonEnd</code> should contain the last season (if applicable) in which a program admitted applicants. If a defunct program merged into a newer one, set the <code>MergeTo</code> field as the name of the newer program; if a current program was created from a previous one, set the <code>SplitFrom</code> field. If a newly-created program has no clear heritage, just leave these blank (but no prior historical data will be available).</p><p>If you&#39;re re-setting the configuration from an existing one, use <code>force=true</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>You need to load the CSV package (<code>using CSV</code>) for <code>set_programs</code> to be available. See the AdmissionSuite web documentation for more information.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/AdmitConfiguration.jl#L46-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.set_sql_queries-Tuple{}" href="#AdmitConfiguration.set_sql_queries-Tuple{}"><code>AdmitConfiguration.set_sql_queries</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_sql_queries(; applicants = &quot;SELECT * FROM ...&quot;, programs = &quot;SELECT * FROM ...&quot;)</code></pre><p>Configure the specific queries needed to obtain the applicants and program targets, respectively. &quot;...&quot; needs to be specified for your local institution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/AdmitConfiguration.jl#L84-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.validateprogram-Tuple{AbstractString}" href="#AdmitConfiguration.validateprogram-Tuple{AbstractString}"><code>AdmitConfiguration.validateprogram</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prog = validateprogram(program::AbstractString)</code></pre><p>Return the abbreviation <code>prog</code> from either a valid abbreviation or valid long-form program name <code>program</code>. An error is thrown if the program is not recognized.</p><p>See <a href="#AdmitConfiguration.set_programs"><code>set_programs</code></a> to configure your local programs, or <a href="#AdmitConfiguration.addprogram-Tuple{AbstractString}"><code>addprogram</code></a> and <a href="#AdmitConfiguration.delprogram-Tuple{AbstractString}"><code>delprogram</code></a> to configure them dynamically.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/utils.jl#L29-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmitConfiguration.when_updated" href="#AdmitConfiguration.when_updated"><code>AdmitConfiguration.when_updated</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">when_updated(row)</code></pre><p>Return date (or date and time) at which a record <code>row</code> was updated in the database. Required for de-duplicating database entries in <code>Admit.keep_final_records</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmitConfiguration/src/local_function_stubs.jl#L57-L62">source</a></section></article><h2 id="API-reference:-AdmissionTargets"><a class="docs-heading-anchor" href="#API-reference:-AdmissionTargets">API reference: AdmissionTargets</a><a id="API-reference:-AdmissionTargets-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference:-AdmissionTargets" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.FacultyRecord" href="#AdmissionTargets.FacultyRecord"><code>AdmissionTargets.FacultyRecord</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>FacultyRecord</code> stores the program affiliations and service contributions of a particular faculty member.</p><ul><li><p><code>start::Dates.Date</code></p><p>Date on which the faculty member was approved to train students in any program</p></li></ul><ul><li><p><code>programs::Vector{String}</code></p><p>Program affiliations, in decreasing order of importance (e.g., primary, secondary, ...)</p></li></ul><ul><li><p><code>service::Vector{Pair{String, Service}}</code></p><p><code>program=&gt;Service</code> contributions (to any program, not just those listed in <code>programs</code>)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/types.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.Service" href="#AdmissionTargets.Service"><code>AdmissionTargets.Service</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>Service</code> measures the service contributions of a particular faculty member to a particular program.</p><ul><li><p><code>ninterviews::Float32</code></p><p>The number of admissions interviews conducted for that program, typically over a fixed time window.</p></li></ul><ul><li><p><code>ncommittees::Float32</code></p><p>The number of thesis committees served on for that program, typically over a fixed time window.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/types.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.ServiceCalibration" href="#AdmissionTargets.ServiceCalibration"><code>AdmissionTargets.ServiceCalibration</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>ServiceCalibration</code> is meant to standardize forms of service to account for the fact that young programs may not have students in thesis committees and therefore don&#39;t have as much service per faculty member.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/types.jl#L28-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.aggregate-Tuple{Union{AbstractDict{var&quot;#s8&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s8&quot;, FacultyRecord}, 1}} where var&quot;#s8&quot;&lt;:AbstractString, Any}" href="#AdmissionTargets.aggregate-Tuple{Union{AbstractDict{var&quot;#s8&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s8&quot;, FacultyRecord}, 1}} where var&quot;#s8&quot;&lt;:AbstractString, Any}"><code>AdmissionTargets.aggregate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">facrecsnew = aggregate(facrecs::ListPairs{&lt;:AbstractString,FacultyRecord}, mergepairs)</code></pre><p>Aggregate faculty records, merging program <code>from =&gt; to</code> pairs from <code>mergepairs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/utils.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.calibrate_service" href="#AdmissionTargets.calibrate_service"><code>AdmissionTargets.calibrate_service</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sc = calibrate_service(progsvc, yrthresh = &lt;7 years ago today&gt;)</code></pre><p>Calculate an equivalence between different forms of service. This is to handle the fact that young programs don&#39;t provide opportunities for service in the form of thesis commmittees. <code>progsvc</code> is from <a href="#AdmissionTargets.program_service-Tuple{Union{AbstractDict{var&quot;#s4&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s4&quot;, FacultyRecord}, 1}} where var&quot;#s4&quot;&lt;:AbstractString}"><code>program_service</code></a>, and <code>yrthresh</code> selects &quot;old&quot; programs (ones that existed prior to <code>yrthresh</code>) useful for calibration.</p><p><code>sc</code> allows a calculation of total service based on the maximum score computed from interviews or from committees.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/targets.jl#L77-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.faculty_affiliations" href="#AdmissionTargets.faculty_affiliations"><code>AdmissionTargets.faculty_affiliations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">naffil = faculty_affiliations(facrecs, scheme)</code></pre><p>Compute the number of affiliations per program. <code>facrecs</code> is a list of <code>facultyname::String =&gt; facrec::FacultyRecord</code> pairs containing details about the affiliations of each faculty member (see <a href="#AdmissionTargets.FacultyRecord"><code>FacultyRecord</code></a>). <code>facrecs</code> can be read via <a href="#AdmissionTargets.read_faculty_data-Tuple{AbstractString, Vararg{Any, N} where N}"><code>read_faculty_data</code></a>.</p><p><code>scheme</code> controls the weighting of affiliations for faculty members with more than one affiliation:</p><ul><li><code>:primary</code> (default): count only the faculty member&#39;s primary affiliation (one vote/faculty)</li><li><code>:all</code>: count all affiliations (multiple votes/faculty depending on the number of affiliations)</li><li><code>:normalized</code>: one vote per faculty, spread equally among all that faculty member&#39;s affiliations</li><li><code>:weighted</code>: one vote per faculty, with decreasing weight. For a faculty member with 3 affiliations, they would be assigned a ratio of 3 to 2 to 1.  Hence the primary program would get 3/6=0.5, secondary 2/6=0.33, and tertiary 1/6=0.17.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/targets.jl#L3-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.faculty_effort-Tuple{Union{AbstractDict{var&quot;#s48&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s48&quot;, FacultyRecord}, 1}} where var&quot;#s48&quot;&lt;:AbstractString, AbstractRange{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Union{Dates.Date, Integer}}" href="#AdmissionTargets.faculty_effort-Tuple{Union{AbstractDict{var&quot;#s48&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s48&quot;, FacultyRecord}, 1}} where var&quot;#s48&quot;&lt;:AbstractString, AbstractRange{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Union{Dates.Date, Integer}}"><code>AdmissionTargets.faculty_effort</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">faculty, programs, E = faculty_effort(facrecs, daterange::AbstractRange; sc=nothing, progrange=&lt;default&gt;)</code></pre><p>Use <code>facrecs</code>, a list of <code>facultyname::String =&gt; facrec::FacultyRecord</code> pairs, to estimate the average annual effort (in hours) contributed in the forms of service tracked in <a href="#AdmissionTargets.Service"><code>Service</code></a>. See <a href="#AdmissionTargets.FacultyRecord"><code>FacultyRecord</code></a> and <a href="#AdmissionTargets.read_faculty_data-Tuple{AbstractString, Vararg{Any, N} where N}"><code>read_faculty_data</code></a>. <code>daterange</code> specifies the time span covered by <code>facrecs</code>; it could be a <code>Date</code> range or something like <code>2016:2020</code> to indicate a span in calendar years. The optional <code>sc</code> allows you to supply a service calibration, see <a href="#AdmissionTargets.calibrate_service"><code>calibrate_service</code></a>. <code>progyears</code> lets you supply a <code>Dict(progname =&gt; yearrange)</code> specifying the duration of existence of each program; the default effectively assumes you&#39;ve called <a href="#AdmissionTargets.aggregate-Tuple{Union{AbstractDict{var&quot;#s8&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s8&quot;, FacultyRecord}, 1}} where var&quot;#s8&quot;&lt;:AbstractString, Any}"><code>aggregate</code></a> on <code>facrecs</code> to consolidate defunct programs into their modern equivalents.</p><p>On output, <code>E</code> is a <code>length(faculty)</code>-by-<code>length(programs)</code> matrix, where <code>E[j,i]</code> measures the average annual effort committed by faculty member <code>faculty[j]</code> to <code>programs[i]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/targets.jl#L106-L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.faculty_involvement-Tuple{AbstractMatrix{T} where T}" href="#AdmissionTargets.faculty_involvement-Tuple{AbstractMatrix{T} where T}"><code>AdmissionTargets.faculty_involvement</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">f = faculty_involvement(E::AbstractMatrix; scheme=:normeffort, annualthresh=3, M=size(E,1))</code></pre><p>Compute the effective number of faculty <code>f[i]</code> involved in program <code>i</code>, based on annual effort <code>E</code> as computed by <a href="#AdmissionTargets.faculty_effort-Tuple{Union{AbstractDict{var&quot;#s48&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s48&quot;, FacultyRecord}, 1}} where var&quot;#s48&quot;&lt;:AbstractString, AbstractRange{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Union{Dates.Date, Integer}}"><code>faculty_effort</code></a>. <code>annualthresh</code> is the number of hours that must be exceeded in order to qualify as a contributing faculty member.</p><p>There are three schemes available:</p><ul><li><code>:thresheffort</code>: <code>f[i]</code> gets a +1 contribution from faculty member <code>j</code> if <code>j</code> exceeded <code>annualthresh</code> in that program. (This allows one faculty member to count multiple times.)</li><li><code>:normeffort</code> (the default): for each faculty member who&#39;s total service hours across all programs exceeds <code>annualthresh</code>, distribute a total of one vote in proportion to service per program.</li><li><code>:effortshare</code>: calculate the average service per faculty member (<code>M</code> faculty members total) for each program. If a faculty member exceeded this threshold for <code>k</code> programs, add <code>1/k</code> to each. <code>annualthresh</code> plays no role here.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/targets.jl#L157-L171">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.program_service-Tuple{Union{AbstractDict{var&quot;#s4&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s4&quot;, FacultyRecord}, 1}} where var&quot;#s4&quot;&lt;:AbstractString}" href="#AdmissionTargets.program_service-Tuple{Union{AbstractDict{var&quot;#s4&quot;, FacultyRecord}, AbstractArray{Pair{var&quot;#s4&quot;, FacultyRecord}, 1}} where var&quot;#s4&quot;&lt;:AbstractString}"><code>AdmissionTargets.program_service</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">progsvc = program_service(facrecs)</code></pre><p>Compute the total service for each program. <code>progsvc</code> is a <code>Dict(progname =&gt; ::Service)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/targets.jl#L62-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.read_faculty_data-Tuple{AbstractString, Vararg{Any, N} where N}" href="#AdmissionTargets.read_faculty_data-Tuple{AbstractString, Vararg{Any, N} where N}"><code>AdmissionTargets.read_faculty_data</code></a> — <span class="docstring-category">Method</span></header><section><div><p>facrecs = read<em>faculty</em>data(filename)</p><p>Read faculty training participation from a file. See &quot;/home/runner/work/AdmissionSuite.jl/AdmissionSuite.jl/AdmissionTargets/src/test/data/facultyinvolvement.csv&quot; for an example of the format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/io.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.targets-NTuple{4, Any}" href="#AdmissionTargets.targets-NTuple{4, Any}"><code>AdmissionTargets.targets</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tgts, parameters = targets(program_napplicants, program_nfaculty, N, minslots)</code></pre><p>Compute the target number of matriculants for each program, reserving some slots to ensure that no program gets fewer than <code>minslots</code>. Slots are assigned via a &quot;hyperbolic&quot; parametrization:</p><p class="math-container">\[n_i = \sqrt{n_0^2 + \frac{{N^\prime}^2 w_i^2}{W^2}}.\]</p><p><code>n₀</code> and <code>N′</code> are <code>parameters</code> computed to ensure that the minimum <code>nᵢ</code> (across all programs) is equal to <code>minslots</code>, and the sum of slots is <code>N</code>. <code>wᵢ</code> is the weight assigned to the <code>i</code>th program and is extracted from <code>program_nfaculty</code>, and <code>W² = ∑ᵢ wᵢ^2</code>. Very small programs might receive most of their slots from <code>n₀</code>, whereas large programs receive approximately a fraction <code>N′/N &lt; 1</code> of the slots they would otherwise receive without <code>minslots</code>.</p><p>This &quot;hyperbolic&quot; approach provides graded program-leveling, reserving the largest boost for small programs. It does not have sharp cutoffs: even programs that would have received barely more than <code>minslots</code> still get some boost.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/targets.jl#L216-L237">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AdmissionTargets.targets-Tuple{Any, Any, Any}" href="#AdmissionTargets.targets-Tuple{Any, Any, Any}"><code>AdmissionTargets.targets</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tgts = targets(program_napplicants, program_nfaculty, N)</code></pre><p>Compute the target number of matriculants for each program. <code>program_napplicants</code> is a collection of <code>program =&gt; napplicants</code> pairs; <code>program_nfaculty</code> is a collection of <code>program =&gt; nfaculty</code> scores (see <a href="#AdmissionTargets.faculty_affiliations"><code>faculty_affiliations</code></a> and <a href="#AdmissionTargets.faculty_involvement-Tuple{AbstractMatrix{T} where T}"><code>faculty_involvement</code></a>). <code>N</code> is the total number of matriculants across all programs.</p><p>Each program gets weighted by the geometric mean of the # of applicants and faculty. In other words, each program gets</p><p class="math-container">\[n_i = N \frac{\sqrt{a_i f_i}}{\sum_k \sqrt{a_k f_k}}\]</p><p>slots.  On output, <code>tgts[program]</code> is the number of slots for <code>program</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/timholy/AdmissionSuite.jl/blob/31b423c4b52369c753c826797c62cc56e375bdde/AdmissionTargets/src/targets.jl#L188-L202">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../targets/">« Targets</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 2 February 2023 19:35">Thursday 2 February 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
